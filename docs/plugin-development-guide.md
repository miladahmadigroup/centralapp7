# ุฑุงูููุง ฺฉุงูู ุชูุณุนู ุงูุฒูููโูุง
## ุณุณุชู ุงูพ ูุฑฺฉุฒ

### ููุฑุณุช ูุทุงูุจ
1. [ููุง ฺฉู](#ููุง-ฺฉู)
2. [ุงูฺฉุงูุงุช ูุณุชู](#ุงูฺฉุงูุงุช-ูุณุชู)
3. [ุดุฑูุน ูพุฑูฺู](#ุดุฑูุน-ูพุฑูฺู)
4. [ุณุงุฎุชุงุฑ ูุงูโูุง](#ุณุงุฎุชุงุฑ-ูุงู-ูุง)
5. [ุชูุธูุงุช ุงูุฒููู](#ุชูุธูุงุช-ุงูุฒููู)
6. [ูุณุชูุฏุงุช ุงูุฒููู](#ูุณุชูุฏุงุช-ุงูุฒููู)
7. [ุชูุณุนู API](#ุชูุณุนู-api)
8. [ุชูุณุนู Views](#ุชูุณุนู-views)
9. [ุตูุญุงุช ูุฏุฑุช](#ุตูุญุงุช-ูุฏุฑุช)
10. [Hooks ู Events](#hooks-ู-events)
11. [ูุฏุฑุช ุฏุชุงุจุณ](#ูุฏุฑุช-ุฏุชุงุจุณ)
12. [ุงููุช](#ุงููุช)
13. [ุชุณุช ู ุฏุจุงฺฏ](#ุชุณุช-ู-ุฏุจุงฺฏ)
14. [ุจูุชุฑู ุดููโูุง](#ุจูุชุฑู-ุดูู-ูุง)
15. [ูุซุงูโูุง ุนูู](#ูุซุงู-ูุง-ุนูู)

---

## ููุง ฺฉู

### ุฎูุด ุขูุฏุฏ ุจู ุฏูุง ุชูุณุนู ุงูุฒููู!

ุณุณุชู ุงูพ ูุฑฺฉุฒ ุงูฺฉุงู ุงุฌุงุฏ ุงูุฒูููโูุง ูุฏุฑุชููุฏ ู ููุนุทู ุฑุง ูุฑุงูู ูโฺฉูุฏ. ุดูุง ูโุชูุงูุฏ ุนููฺฉุฑุฏูุง ุฌุฏุฏ ุงุถุงูู ฺฉูุฏุ API ูุง ุณูุงุฑุด ุงุฌุงุฏ ฺฉูุฏ ู ูููุง ุชุนุงูู ุจุณุงุฒุฏ.

### ฺุฑุง ุงูุฒููู ุจุณุงุฒูุ

- **ูุงุจูุช ุชูุณุนู:** ุงูุฒูุฏู ุนููฺฉุฑุฏูุง ุฌุฏุฏ ุจุฏูู ุชุบุฑ ูุณุชู
- **ูุงฺููุงุฑ ุจูุฏู:** ูุฑ ุงูุฒููู ูุณุชูู ู ูุงุจู ูุนุงู/ุบุฑูุนุงู ฺฉุฑุฏู
- **ุณุงุฒฺฏุงุฑ:** ุชุนุงูู ุขุณุงู ุจุง ุณุงุฑ ุงูุฒูููโูุง
- **ุจูโุฑูุฒุฑุณุงู ุขุณุงู:** ุจุฑูุฒุฑุณุงู ุจุฏูู ุงุฒ ุฏุณุช ุฏุงุฏู ุชุบุฑุงุช

### ูุจู ุงุฒ ุดุฑูุน

โ๏ธ **ูฺฉุงุช ููู:**
- ุญุชูุงู ูุณุชูุฏุงุช ุณุงุฑ ุงูุฒูููโูุง ูุตุจ ุดุฏู ุฑุง ูุทุงูุนู ฺฉูุฏ
- ุงุฒ ุชุฏุงุฎู ุจุง ุนููฺฉุฑุฏูุง ุณุงุฑ ุงูุฒูููโูุง ุฌููฺฏุฑ ฺฉูุฏ
- ุงุฒ ุงุณุชุงูุฏุงุฑุฏูุง ฺฉุฏููุณ ูพุฑู ฺฉูุฏ
- ูููุงุฑู ุงููุช ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ

---

## ุงูฺฉุงูุงุช ูุณุชู

### ูฺฺฏโูุง ุงุตู

#### ๐๏ธ ูุฏุฑุช ุฏุชุงุจุณ
ุฏุณุชุฑุณ ุขุณุงู ุจู ุฏุชุงุจุณ ุจุง ฺฉูุงุณ Database ู ุงูฺฉุงู ุงุฌุฑุง ฺฉูุฆุฑโูุง ูพฺุฏู

#### ๐ ุณุณุชู ุงุญุฑุงุฒ ููุช  
ูุฏุฑุช ฺฉุงุฑุจุฑุงูุ JWT tokensุ ู ุณุณุชู ุฏุณุชุฑุณโูุง ฺูุฏุณุทุญู

#### ๐พ ุณุณุชู ฺฉุด
ฺฉุด ุฎูุฏฺฉุงุฑ ุจุฑุง API ู Views ุจุง ูุงุจูุช ุชูุธู ุฒูุงู ุงููุถุง

#### ๐ Hook System
ุณุณุชู ุฑูุฏุงุฏูุง ุจุฑุง ุงุฑุชุจุงุท ุจู ุงูุฒูููโูุง ู ุงุฌุฑุง ููุฒูุงู ุนููุงุช

#### ๐ API Framework
ุณุงุฎุชุงุฑ ุขูุงุฏู ุจุฑุง ุงุฌุงุฏ REST API ูุง ูุฏุฑุชููุฏ

#### ๐๏ธ View Engine
ุณุณุชู ูุงูุจโุจูุฏ ุจุฑุง ุงุฌุงุฏ ุฑุงุจุทโูุง ฺฉุงุฑุจุฑ ุชุนุงูู

### ููู ูุฏุฑุช (ูุงููุฏ WordPress)

```php
// ุฏุฑ ูุงู main.php ุงูุฒููู
class MyPlugin {
    public function __construct() {
        add_action('admin_menu', [$this, 'addAdminMenu']);
    }
    
    public function addAdminMenu($menuItems) {
        $menuItems[] = [
            'title' => 'ูุฏุฑุช ฺฉุงุฑุจุฑุงู',
            'url' => BASE_URL . '/admin/my-plugin/users',
            'icon' => 'fas fa-users',
            'badge' => '5', // ุงุฎุชุงุฑ
            'capability' => 'manage_users' // ุงุฎุชุงุฑ
        ];
        
        return $menuItems;
    }
}
```

### ูุฏุฑุช ุฑูุฏุงุฏูุง ููุฒูุงู

```php
// ุซุจุช ุฑูุฏุงุฏ
add_action('user_registered', function($userData) {
    // ุงุฑุณุงู ุงูู ุฎูุดโุขูุฏฺฏู
    sendWelcomeEmail($userData['email']);
}, 10); // ุงูููุช 10

// ุงุฌุฑุง ุฑูุฏุงุฏ
do_action('user_registered', $newUserData);

// ููุชุฑ ุฏุงุฏูโูุง
add_filter('user_display_name', function($name, $user) {
    return strtoupper($name);
}, 10, 2);

$displayName = apply_filters('user_display_name', $user['name'], $user);
```

---

## ุดุฑูุน ูพุฑูฺู

### ฺฏุงู 1: ุงูุชุฎุงุจ ูุงู ุงูุฒููู
ูุงู ุจุงุฏ ููุญุตุฑ ุจู ูุฑุฏุ ฺฉูุชุงู ู ุชูุตู ุจุงุดุฏ. ุงุฒ ุญุฑูู ฺฉูฺฺฉ ู ุฎุท ุชุฑู ุงุณุชูุงุฏู ฺฉูุฏ.

**ูุซุงูโูุง ููุงุณุจ:**
- user-management
- online-shop  
- payment-gateway
- email-marketing

### ฺฏุงู 2: ุงุฌุงุฏ ูพูุดู ุงูุฒููู

```bash
mkdir plugins/my-awesome-plugin
cd plugins/my-awesome-plugin
```

### ฺฏุงู 3: ุจุฑุฑุณ ุงูุฒูููโูุง ููุฌูุฏ
ูุจู ุงุฒ ุดุฑูุนุ ูุณุชูุฏุงุช ุงูุฒูููโูุง ูุตุจ ุดุฏู ุฑุง ูุทุงูุนู ฺฉูุฏ:
- ูุณุช API ูุง ููุฌูุฏ
- ูููุง ูุงุจู ุงุณุชูุงุฏู
- Hook ูุง ุฏุฑ ุฏุณุชุฑุณ
- ุฌุฏุงูู ุฏุชุงุจุณ ููุฌูุฏ

---

## ุณุงุฎุชุงุฑ ูุงูโูุง

```
plugins/my-plugin/
โโโ plugin.json          # ุชูุธูุงุช ุงูุฒููู (ุงูุฒุงู)
โโโ main.php             # ฺฉูุงุณ ุงุตู ุงูุฒููู (ุงูุฒุงู)
โโโ docs.json            # ูุณุชูุฏุงุช ฺฉุงูู (ุงูุฒุงู)
โโโ api.php              # API endpoints (ุงุฎุชุงุฑ)
โโโ install.sql          # ุฌุฏุงูู ุฏุชุงุจุณ (ุงุฎุชุงุฑ)
โโโ uninstall.php        # ุญุฐู ุฏุงุฏูโูุง (ุงุฎุชุงุฑ)
โโโ admin/               # ุตูุญุงุช ูุฏุฑุช
โ   โโโ index.php
โ   โโโ settings.php
โ   โโโ users.php
โโโ views/               # ูููุง ุงูพ ฺฉูุงูุช
โ   โโโ login.php
โ   โโโ register.php
โ   โโโ profile.php
โโโ assets/              # ูุงูโูุง ุงุณุชุงุชฺฉ
โ   โโโ css/
โ   โโโ js/
โ   โโโ images/
โโโ includes/            # ูุงูโูุง ฺฉูฺฉ
โ   โโโ functions.php
โ   โโโ class-helper.php
โโโ languages/           # ูุงูโูุง ุชุฑุฌูู
    โโโ fa_IR.po
    โโโ en_US.po
```

### ูุงูโูุง ุงูุฒุงู

โ ุจุฏูู ุงู ุณู ูุงูุ ุงูุฒููู ูุงุจู ูุตุจ ูุณุช:
- **plugin.json** - ุงุทูุงุนุงุช ุงุณุงุณ ุงูุฒููู
- **main.php** - ฺฉูุงุณ ุงุตู ู ููุทู ุงูุฒููู  
- **docs.json** - ูุณุชูุฏุงุช ฺฉุงูู ุงูุฒููู

---

## ุชูุธูุงุช ุงูุฒููู

### ูุงู plugin.json

```json
{
  "name": "user-management",
  "version": "1.0.0",
  "description": "ุณุณุชู ฺฉุงูู ูุฏุฑุช ฺฉุงุฑุจุฑุงู",
  "author": "ูุงู ุดูุง",
  "website": "https://yourwebsite.com",
  "license": "MIT",
  "dependencies": [
    "email-service"
  ],
  "api_endpoints": [
    "login",
    "register", 
    "profile",
    "logout"
  ],
  "views": [
    "login",
    "register",
    "profile"
  ],
  "admin_pages": [
    "users",
    "settings"
  ],
  "database_tables": [
    "users",
    "user_sessions"
  ],
  "hooks": [
    "user_registered",
    "user_login",
    "user_logout"
  ],
  "permissions": [
    "manage_users",
    "edit_user_profiles"
  ]
}
```

### ููุฏูุง ููู:
- **name:** ุดูุงุณู ฺฉุชุง ุงูุฒููู (ููุท ุญุฑููุ ุงุนุฏุงุฏ ู ุฎุท ุชุฑู)
- **dependencies:** ุงูุฒูููโูุง ฺฉู ุจุงุฏ ูุนุงู ุจุงุดูุฏ
- **api_endpoints:** ูุณุช API ูุง ุงุฑุงุฆู ุดุฏู
- **views:** ูุณุช ูููุง ูุงุจู ุงุณุชูุงุฏู
- **hooks:** ุฑูุฏุงุฏูุง ฺฉู ุงูุฒููู ุงุฌุงุฏ ูโฺฉูุฏ

---

## ูุณุชูุฏุงุช ุงูุฒููู

### ูุงู docs.json (ุงูุฒุงู)

โ๏ธ **ูฺฉุชู ููู:** ุจุฏูู ูุงู docs.jsonุ ุงูุฒููู ูุงุจู ูุตุจ ูุณุช.

```json
{
  "plugin": {
    "name": "user-management",
    "display_name": "ูุฏุฑุช ฺฉุงุฑุจุฑุงู", 
    "version": "1.0.0",
    "description": "ุณุณุชู ฺฉุงูู ูุฏุฑุช ฺฉุงุฑุจุฑุงู",
    "author": "ูุงู ุดูุง"
  },
  "api_endpoints": [
    {
      "name": "login",
      "method": "POST",
      "path": "/login",
      "description": "ูุฑูุฏ ฺฉุงุฑุจุฑ ุจู ุณุณุชู",
      "parameters": {
        "required": [
          {
            "name": "email",
            "type": "string",
            "description": "ุขุฏุฑุณ ุงูู"
          }
        ]
      },
      "example_request": "callCentralAPI('user-management', 'login', data)"
    }
  ],
  "views": [
    {
      "name": "login",
      "description": "ูุฑู ูุฑูุฏ ฺฉุงุฑุจุฑ",
      "usage_example": "getViewFromCentral('user-management', 'login')"
    }
  ],
  "setup": {
    "installation": [
      "ูุงูโูุง ุงูุฒููู ุฑุง ุฏุฑ ูพูุดู plugins ฺฉูพ ฺฉูุฏ",
      "ุงูุฒููู ุฑุง ุงุฒ ุฏุงุดุจูุฑุฏ ูุตุจ ฺฉูุฏ"
    ]
  }
}
```

---

## ุชูุณุนู API

### ูุงู api.php

```php
<?php
// ุฏุฑุงูุช action ู data ุงุฒ global
$action = $GLOBALS['plugin_action'] ?? '';
$data = $GLOBALS['plugin_data'] ?? [];

// ูุณุฑุงุจ ุฏุฑุฎูุงุณุชโูุง
switch ($action) {
    case 'login':
        handleLogin($data);
        break;
        
    case 'register':
        handleRegister($data);
        break;
        
    case 'profile':
        handleProfile($data);
        break;
        
    default:
        jsonResponse([
            'success' => false,
            'message' => 'ุนููุงุช ูุงูุนุชุจุฑ'
        ], 400);
}

function handleLogin($data) {
    global $db;
    
    // ุงุนุชุจุงุฑุณูุฌ
    if (empty($data['email']) || empty($data['password'])) {
        jsonResponse([
            'success' => false,
            'message' => 'ุงูู ู ุฑูุฒ ุนุจูุฑ ุงูุฒุงู ุงุณุช'
        ], 400);
    }
    
    try {
        // ุจุฑุฑุณ ฺฉุงุฑุจุฑ
        $stmt = $db->prepare("SELECT * FROM users WHERE email = ?");
        $stmt->execute([$data['email']]);
        $user = $stmt->fetch();
        
        if ($user && verifyPassword($data['password'], $user['password'])) {
            // ุชููุฏ JWT token
            $auth = new Auth();
            $token = $auth->generateJWT([
                'user_id' => $user['id'],
                'email' => $user['email']
            ]);
            
            // ุงุฌุฑุง hook
            do_action('user_login', $user);
            
            jsonResponse([
                'success' => true,
                'message' => 'ูุฑูุฏ ูููู',
                'data' => [
                    'user' => [
                        'id' => $user['id'],
                        'email' => $user['email'],
                        'name' => $user['name']
                    ],
                    'token' => $token
                ]
            ]);
        } else {
            jsonResponse([
                'success' => false,
                'message' => 'ุงุทูุงุนุงุช ูุฑูุฏ ุงุดุชุจุงู ุงุณุช'
            ], 401);
        }
    } catch (Exception $e) {
        logError('Login error: ' . $e->getMessage());
        jsonResponse([
            'success' => false,
            'message' => 'ุฎุทุง ุฏุงุฎู ุณุฑูุฑ'
        ], 500);
    }
}
?>
```

### ุจูุชุฑู ุดููโูุง API:
- ููุดู ุงุนุชุจุงุฑุณูุฌ ูุฑูุฏโูุง ุฑุง ุงูุฌุงู ุฏูุฏ
- ุงุฒ try-catch ุจุฑุง ูุฏุฑุช ุฎุทุงูุง ุงุณุชูุงุฏู ฺฉูุฏ
- ฺฉุฏูุง ูุถุนุช HTTP ููุงุณุจ ุจุฑฺฏุฑุฏุงูุฏ
- ุฎุทุงูุง ุฑุง ูุงฺฏ ฺฉูุฏ
- ุงุฒ Hook ูุง ุจุฑุง ุงุทูุงุนโุฑุณุงู ุจู ุณุงุฑ ุงูุฒูููโูุง ุงุณุชูุงุฏู ฺฉูุฏ

---

## ุชูุณุนู Views

ูููุง ูุงูโูุง PHP ูุณุชูุฏ ฺฉู HTML ุชููุฏ ูโฺฉููุฏ ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุงูพโูุง ฺฉูุงูุช:

```php
<?php
// views/login.php

// ุฏุฑุงูุช ูพุงุฑุงูุชุฑูุง
$redirect_url = $redirect_url ?? '/dashboard';
$theme = $theme ?? 'light';
?>

<div class="central-widget login-widget" data-theme="<?php echo htmlspecialchars($theme); ?>">
    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">ูุฑูุฏ ุจู ุณุณุชู</h5>
        </div>
        <div class="card-body">
            <form id="centralLoginForm" data-central-widget="login" data-redirect-url="<?php echo htmlspecialchars($redirect_url); ?>">
                <div class="mb-3">
                    <label for="email" class="form-label">ุงูู</label>
                    <input type="email" class="form-control" name="email" required>
                </div>
                
                <div class="mb-3">
                    <label for="password" class="form-label">ุฑูุฒ ุนุจูุฑ</label>
                    <input type="password" class="form-control" name="password" required>
                </div>
                
                <button type="submit" class="btn btn-primary w-100">ูุฑูุฏ</button>
            </form>
        </div>
    </div>
</div>

<script>
document.getElementById('centralLoginForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = Object.fromEntries(formData);
    
    callCentralAPI('user-management', 'login', data)
        .then(response => {
            if (response.success) {
                localStorage.setItem('central_auth_token', response.data.token);
                window.location.href = this.dataset.redirectUrl || '/';
            } else {
                showAlert('error', response.message);
            }
        });
});
</script>

<style>
.login-widget[data-theme="dark"] {
    background-color: #343a40;
    color: #fff;
}
</style>
```

### ูฺฉุงุช ููู Views:
- ููุดู ูพุงุฑุงูุชุฑูุง ุฑุง sanitize ฺฉูุฏ
- ุงุฒ Bootstrap classes ุงุณุชูุงุฏู ฺฉูุฏ
- RTL ุฑุง ูพุดุชุจุงู ฺฉูุฏ
- JavaScript ุฑุง inline ุจููุณุฏ
- CSS ุณูุงุฑุด ุฑุง ุฏุฑ ููุงู ูุงู ูุฑุงุฑ ุฏูุฏ

---

## ุตูุญุงุช ูุฏุฑุช

ุตูุญุงุช ูุฏุฑุช ุฏุฑ ูพูุดู `admin/` ูุฑุงุฑ ูโฺฏุฑูุฏ:

```php
<?php
// admin/users.php

require_once __DIR__ . '/../../config.php';
require_once __DIR__ . '/../../core/functions.php';

// ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
$auth = new Auth();
$auth->requireAdminLogin();

$pageTitle = 'ูุฏุฑุช ฺฉุงุฑุจุฑุงู';

// ุฏุฑุงูุช ูุณุช ฺฉุงุฑุจุฑุงู
try {
    global $db;
    $stmt = $db->prepare("SELECT * FROM users ORDER BY created_at DESC");
    $stmt->execute();
    $users = $stmt->fetchAll();
} catch (Exception $e) {
    $users = [];
}

ob_start();
?>

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>ูุฏุฑุช ฺฉุงุฑุจุฑุงู</h1>
    <button class="btn btn-primary">ุงูุฒูุฏู ฺฉุงุฑุจุฑ</button>
</div>

<div class="card">
    <div class="card-body">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>ูุงู</th>
                    <th>ุงูู</th>
                    <th>ุชุงุฑุฎ ุนุถูุช</th>
                </tr>
            </thead>
            <tbody>
                <?php foreach ($users as $user): ?>
                <tr>
                    <td><?php echo htmlspecialchars($user['name']); ?></td>
                    <td><?php echo htmlspecialchars($user['email']); ?></td>
                    <td><?php echo date('Y/m/d', strtotime($user['created_at'])); ?></td>
                </tr>
                <?php endforeach; ?>
            </tbody>
        </table>
    </div>
</div>

<?php
$content = ob_get_clean();
include __DIR__ . '/../../admin/layout.php';
?>
```

### ุงุถุงูู ฺฉุฑุฏู ุจู ููู ุงุฏูู:

```php
// ุฏุฑ ูุงู main.php
add_filter('admin_menu_items', function($items) {
    $items[] = [
        'title' => 'ฺฉุงุฑุจุฑุงู',
        'url' => BASE_URL . '/plugins/user-management/admin/users.php',
        'icon' => 'fas fa-users',
        'badge' => '5'
    ];
    return $items;
});
```

---

## Hooks ู Events

### ุงููุงุน Hooks:

#### Actions
ุจุฑุง ุงุฌุฑุง ฺฉุฏูุง ุฎุงุต ุฏุฑ ููุงุท ูุนู

```php
// ุซุจุช action
add_action('user_registered', 'sendWelcomeEmail');

// ุงุฌุฑุง action  
do_action('user_registered', $userData);
```

#### Filters  
ุจุฑุง ุชุบุฑ ุง ููุชุฑ ฺฉุฑุฏู ุฏุงุฏูโูุง

```php
// ุซุจุช filter
add_filter('user_display_name', 'formatUserName');

// ุงุนูุงู filter
$name = apply_filters('user_display_name', $rawName);
```

### Hook ูุง ูพุดโุชุนุฑู ุดุฏู ุณุณุชู:
- `admin_menu_items` - ุงุถุงูู ฺฉุฑุฏู ููู ุจู ุงุฏูู
- `plugin_activated` - ููฺฏุงู ูุนุงู ุดุฏู ุงูุฒููู
- `plugin_deactivated` - ููฺฏุงู ุบุฑูุนุงู ุดุฏู ุงูุฒููู
- `api_request_before` - ูุจู ุงุฒ ูพุฑุฏุงุฒุด API
- `api_request_after` - ุจุนุฏ ุงุฒ ูพุฑุฏุงุฒุด API

### ูุซุงู ฺฉุงุฑุจุฑุฏ:

```php
// ุงูุฒููู A: ูุฏุฑุช ฺฉุงุฑุจุฑุงู
class UserManagement {
    public function __construct() {
        add_action('user_registered', [$this, 'onUserRegister']);
    }
    
    public function registerUser($data) {
        $userId = $this->saveUser($data);
        
        // ุงุฌุฑุง hook ุจุฑุง ุณุงุฑ ุงูุฒูููโูุง
        do_action('user_registered', [
            'user_id' => $userId,
            'email' => $data['email'],
            'name' => $data['name']
        ]);
    }
}

// ุงูุฒููู B: ุณุณุชู ุงูู
class EmailService {
    public function __construct() {
        add_action('user_registered', [$this, 'sendWelcomeEmail']);
    }
    
    public function sendWelcomeEmail($userData) {
        $this->sendEmail(
            $userData['email'],
            'ุฎูุด ุขูุฏุฏ',
            "ุณูุงู {$userData['name']}, ุจู ุณุงุช ูุง ุฎูุด ุขูุฏุฏ!"
        );
    }
}
```

---

## ูุฏุฑุช ุฏุชุงุจุณ

### ูุงู install.sql

```sql
-- ุฌุฏูู ฺฉุงุฑุจุฑุงู
CREATE TABLE IF NOT EXISTS `plugin_users` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  `email` varchar(255) NOT NULL UNIQUE,
  `password` varchar(255) NOT NULL,
  `status` enum('active','inactive') DEFAULT 'active',
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `email` (`email`),
  KEY `status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ุฌุฏูู ูุดุณุชโูุง ฺฉุงุฑุจุฑ
CREATE TABLE IF NOT EXISTS `plugin_user_sessions` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `token` varchar(255) NOT NULL,
  `expires_at` timestamp NOT NULL,
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  KEY `token` (`token`),
  FOREIGN KEY (`user_id`) REFERENCES `plugin_users`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

### ุงุณุชูุงุฏู ุงุฒ ุฏุชุงุจุณ:

```php
// ุฏุฑุงูุช ุงุชุตุงู ุฏุชุงุจุณ
global $db;

// Insert
$stmt = $db->prepare("INSERT INTO users (name, email, password) VALUES (?, ?, ?)");
$result = $stmt->execute([$name, $email, $hashedPassword]);
$userId = $db->lastInsertId();

// Select
$stmt = $db->prepare("SELECT * FROM users WHERE email = ?");
$stmt->execute([$email]);
$user = $stmt->fetch();

// Update
$stmt = $db->prepare("UPDATE users SET name = ? WHERE id = ?");
$stmt->execute([$newName, $userId]);

// Delete
$stmt = $db->prepare("DELETE FROM users WHERE id = ?");
$stmt->execute([$userId]);
```

---

## ุงููุช

### ุงุนุชุจุงุฑุณูุฌ ูุฑูุฏโูุง:

```php
function validateAndSanitize($data) {
    $clean = [];
    
    // ุงูู
    if (isset($data['email'])) {
        $clean['email'] = filter_var($data['email'], FILTER_VALIDATE_EMAIL);
        if (!$clean['email']) {
            throw new Exception('ุงูู ูุนุชุจุฑ ูุณุช');
        }
    }
    
    // ูุงู
    if (isset($data['name'])) {
        $clean['name'] = trim(strip_tags($data['name']));
        if (strlen($clean['name']) < 2) {
            throw new Exception('ูุงู ุจุงุฏ ุญุฏุงูู 2 ฺฉุงุฑุงฺฉุชุฑ ุจุงุดุฏ');
        }
    }
    
    return $clean;
}
```

### ูุญุงูุธุช ุงุฒ SQL Injection:

```php
// ุฏุฑุณุช โ
$stmt = $db->prepare("SELECT * FROM users WHERE email = ? AND status = ?");
$stmt->execute([$email, $status]);

// ุบูุท โ
$query = "SELECT * FROM users WHERE email = '$email'";
$result = $db->query($query);
```

### ูุญุงูุธุช ุงุฒ XSS:

```php
// ุฏุฑ PHP
echo htmlspecialchars($userInput, ENT_QUOTES, 'UTF-8');

// ุฏุฑ JavaScript
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}
```

---

## ุชุณุช ู ุฏุจุงฺฏ

### ุงุจุฒุงุฑูุง ุชุณุช:
1. **ูุงู ุชุณุช ุงุนุชุจุงุฑุณูุฌ:** `plugin_validation_test.php`
2. **ูุงฺฏ ุฎุทุงูุง:** `logs/error.log`  
3. **API Testing:** Postman ุง curl

### ุชุณุช API ุจุง curl:

```bash
# ุชุณุช login
curl -X POST "http://localhost/centralapp/api/plugins/user-management/login" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"123456"}'

# ุชุณุช profile
curl -X GET "http://localhost/centralapp/api/plugins/user-management/profile" \
  -H "Authorization: Bearer YOUR_API_KEY"
```

### ุฏุจุงฺฏ ฺฉุฑุฏู:

```php
function debugLog($message, $data = null) {
    $log = date('Y-m-d H:i:s') . ' - ' . $message;
    if ($data) {
        $log .= ' - Data: ' . json_encode($data, JSON_UNESCAPED_UNICODE);
    }
    file_put_contents(__DIR__ . '/debug.log', $log . PHP_EOL, FILE_APPEND);
}

// ุงุณุชูุงุฏู
debugLog('User login attempt', ['email' => $email, 'ip' => $_SERVER['REMOTE_ADDR']]);
```

---

## ุจูุชุฑู ุดููโูุง

### ฺฉุฏููุณ
- ุงุฒ PSR-4 ุงุณุชูุงุฏู ฺฉูุฏ
- ฺฉุงููุชโูุง ููุฏ ุจููุณุฏ  
- ูุชุบุฑูุง ุฑุง ูุนูุงุฏุงุฑ ูุงูโฺฏุฐุงุฑ ฺฉูุฏ
- ุงุฒ try-catch ุงุณุชูุงุฏู ฺฉูุฏ

### ุฏุชุงุจุณ
- ููุดู ุงุฒ prepared statements ุงุณุชูุงุฏู ฺฉูุฏ
- ุงูุฏฺฉุณโูุง ููุงุณุจ ุชุนุฑู ฺฉูุฏ
- ููุฏูุง ุญุณุงุณ ุฑุง ุฑูุฒูฺฏุงุฑ ฺฉูุฏ
- backup ููุธู ุฏุงุดุชู ุจุงุดุฏ

### ุชุฌุฑุจู ฺฉุงุฑุจุฑ
- ูพุงูโูุง ุฎุทุง ูุงุถุญ
- Loading states ููุงุณุจ
- ุทุฑุงุญ ุฑุณูพุงูุณู
- ูพุดุชุจุงู ุงุฒ RTL

### ุนููฺฉุฑุฏ
- ุงุฒ ฺฉุด ุงุณุชูุงุฏู ฺฉูุฏ
- ฺฉูุฆุฑโูุง ุจููู ุจููุณุฏ
- ูุงูโูุง CSS/JS ุฑุง minify ฺฉูุฏ
- ุชุตุงูุฑ ุฑุง ุจููู ฺฉูุฏ

---

## ูุซุงูโูุง ุนูู

### ูุซุงู 1: ุงูุฒููู ุณุงุฏู ุดูุงุฑูุฏู ุจุงุฒุฏุฏ

```php
// main.php
class VisitCounterPlugin {
    public function __construct() {
        add_action('page_view', [$this, 'incrementCounter']);
    }
    
    public function incrementCounter($pageId) {
        global $db;
        
        $stmt = $db->prepare("
            INSERT INTO page_visits (page_id, visit_date, visits) 
            VALUES (?, CURDATE(), 1)
            ON DUPLICATE KEY UPDATE visits = visits + 1
        ");
        $stmt->execute([$pageId]);
    }
    
    public function getVisitCount($pageId) {
        global $db;
        
        $stmt = $db->prepare("SELECT SUM(visits) FROM page_visits WHERE page_id = ?");
        $stmt->execute([$pageId]);
        return $stmt->fetchColumn() ?: 0;
    }
}

new VisitCounterPlugin();
```

### ูุซุงู 2: ูุฌุช ููุงุด ุขุจ ู ููุง

```php
// views/weather.php
<?php
$city = $city ?? 'Tehran';
$apiKey = getSetting('weather_api_key');

if ($apiKey) {
    $weatherData = getWeatherData($city, $apiKey);
}

function getWeatherData($city, $apiKey) {
    $url = "http://api.openweathermap.org/data/2.5/weather?q={$city}&appid={$apiKey}&units=metric";
    $response = file_get_contents($url);
    return json_decode($response, true);
}
?>

<div class="weather-widget central-widget">
    <?php if (isset($weatherData) && $weatherData): ?>
    <div class="weather-info">
        <h5><?php echo htmlspecialchars($weatherData['name']); ?></h5>
        <div class="temperature"><?php echo round($weatherData['main']['temp']); ?>ยฐC</div>
        <div class="description"><?php echo htmlspecialchars($weatherData['weather'][0]['description']); ?></div>
    </div>
    <?php else: ?>
    <div class="alert alert-warning">ุงุทูุงุนุงุช ุขุจ ู ููุง ุฏุฑ ุฏุณุชุฑุณ ูุณุช</div>